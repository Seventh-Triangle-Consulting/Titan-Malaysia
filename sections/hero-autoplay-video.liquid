{{ 'hero-autoplay-video.css' | asset_url | stylesheet_tag }}

<style>
  .autoplay-video-section .mobile-video { display: none; }
  {% if section.settings.video_mobile != blank %}
    @media screen and (max-width: 768px) {
      .autoplay-video-section .desktop-video { display: none; }
      .autoplay-video-section .mobile-video { display: block; }
    }
  {% endif %} 


  .section-{{ section.id }} {
    margin-bottom: {{ section.settings.margin_bottom_desktop }}px;
    padding-top: {{ section.settings.padding_top_desktop }}px;
    padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
  }

  @media only screen and (min-width: 750px) and (max-width: 1023px){
    .section-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_tablet }}px;
      padding-bottom: {{ section.settings.padding_bottom_tablet }}px;
    }
  }

  @media only screen and (max-width: 749px){
    .section-{{ section.id }} {
      margin-bottom: {{ section.settings.margin_bottom_mobile }}px;
      padding-top: {{ section.settings.padding_top_mobile }}px;
      padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    }
  }
</style>

<section class="section-{{ section.id }} autoplay-video-section">
  {% if section.settings.video_desktop != blank and section.settings.video_mobile != blank %}
  <div class="container">
    {% if section.settings.video_desktop != blank %}
      {{
        section.settings.video_desktop
        | video_tag:
          autoplay: true,
          muted: true,
          loop: true,
          controls: false,
          playsinline: true,
          class: 'desktop-video',
          id: "background-video-desktop"
      }}
    {% comment %} <video id="background-video-desktop" autoplay muted loop playsinline class="desktop-video">
    {% for source in section.settings.video_desktop.sources %}
      {% if source.format == 'mp4' %}
          <source src="{{ source.url }}" type="{{ source.mime_type }}">
        {% endif %}
      {% endfor %}
    </video> {% endcomment %}
    {% endif %}
    {% if section.settings.video_mobile != blank %}
      {{
        section.settings.video_desktop
        | video_tag:
          autoplay: true,
          muted: true,
          loop: true,
          controls: false,
          playsinline: true,
          class: 'mobile-video',
          id: "background-video-mobile"
      }}
    {% comment %} <video id="background-video-mobile" autoplay muted loop playsinline class="mobile-video">
    {% for source in section.settings.video_mobile.sources %}
      {% if source.format == 'mp4' %}
          <source src="{{ source.url }}" type="{{ source.mime_type }}">
        {% endif %}
      {% endfor %}
    </video> {% endcomment %}
    {% endif %}

    <!-- Controls -->
    <div class="video-controls">
      <!-- Left: Play / Pause -->
      <svg id="play-pause" xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none">
        <path d="M14.5 0C6.50234 0 0 6.50234 0 14.5C0 22.4977 6.50234 29 14.5 29C22.4977 29 29 22.4977 29 14.5C29 6.50234 22.4977 0 14.5 0ZM14.5 27.1875C7.50488 27.1875 1.8125 21.4951 1.8125 14.5C1.8125 7.50488 7.50488 1.8125 14.5 1.8125C21.4951 1.8125 27.1875 7.50488 27.1875 14.5C27.1875 21.4951 21.4951 27.1875 14.5 27.1875ZM12.2061 9.3627V19.6373C12.2061 20.1357 11.7982 20.5436 11.2998 20.5436C10.8014 20.5436 10.3936 20.1357 10.3936 19.6373V9.3627C10.3936 8.86426 10.8014 8.45645 11.2998 8.45645C11.7982 8.45645 12.2061 8.85859 12.2061 9.3627ZM18.6064 9.3627V19.6373C18.6064 20.1357 18.1986 20.5436 17.7002 20.5436C17.2018 20.5436 16.7939 20.1357 16.7939 19.6373V9.3627C16.7939 8.86426 17.2018 8.45645 17.7002 8.45645C18.1986 8.45645 18.6064 8.85859 18.6064 9.3627Z" fill="white"/>
      </svg>

      <!-- Center: Scroll Down -->
      <svg id="scroll-down" xmlns="http://www.w3.org/2000/svg" width="86" height="53" viewBox="0 0 86 53" fill="none">
        <path d="M0.755125 44.436C0.755125 43.932 0.911125 43.5 1.22313 43.14C1.54313 42.78 1.92313 42.524 2.36313 42.372C2.81113 42.22 3.28313 42.144 3.77913 42.144C4.65113 42.144 5.36713 42.348 5.92713 42.756C6.49513 43.156 6.85913 43.728 7.01913 44.472H6.17913C5.86713 43.432 5.03913 42.912 3.69513 42.912C3.36713 42.912 3.05113 42.956 2.74713 43.044C2.45113 43.124 2.18313 43.284 1.94313 43.524C1.70313 43.756 1.58313 44.048 1.58313 44.4C1.58313 45.16 2.14313 45.672 3.26313 45.936L4.29513 46.164C4.68713 46.252 5.01913 46.344 5.29113 46.44C5.57113 46.536 5.87513 46.676 6.20312 46.86C6.53113 47.044 6.78313 47.284 6.95913 47.58C7.13513 47.876 7.22313 48.22 7.22313 48.612C7.22313 49.412 6.91113 50.036 6.28713 50.484C5.66313 50.932 4.90313 51.156 4.00713 51.156C2.95913 51.156 2.12713 50.9 1.51113 50.388C0.903125 49.868 0.547125 49.2 0.443125 48.384H1.28313C1.57113 49.72 2.46713 50.388 3.97113 50.388C4.23513 50.388 4.49513 50.364 4.75113 50.316C5.01513 50.26 5.27513 50.176 5.53113 50.064C5.78713 49.944 5.99113 49.772 6.14313 49.548C6.30313 49.316 6.38313 49.048 6.38313 48.744C6.38313 47.856 5.63113 47.248 4.12713 46.92L3.03513 46.68C1.51513 46.344 0.755125 45.596 0.755125 44.436ZM14.8091 48.204H15.6491C15.4491 49.108 15.0331 49.828 14.4011 50.364C13.7691 50.892 12.9571 51.156 11.9651 51.156C10.7491 51.156 9.80109 50.744 9.12109 49.92C8.44109 49.088 8.10109 47.996 8.10109 46.644C8.10109 45.292 8.44509 44.204 9.13309 43.38C9.82109 42.556 10.7771 42.144 12.0011 42.144C12.9611 42.144 13.7531 42.412 14.3771 42.948C15.0011 43.476 15.4131 44.192 15.6131 45.096H14.7731C14.5971 44.392 14.2571 43.852 13.7531 43.476C13.2491 43.1 12.6571 42.912 11.9771 42.912C11.0891 42.912 10.3611 43.244 9.79309 43.908C9.23309 44.564 8.95309 45.476 8.95309 46.644C8.95309 47.788 9.22909 48.7 9.78109 49.38C10.3411 50.052 11.0731 50.388 11.9771 50.388C12.7611 50.388 13.3931 50.18 13.8731 49.764C14.3531 49.348 14.6651 48.828 14.8091 48.204ZM22.3837 51L20.3317 47.136C20.1877 47.152 20.0677 47.16 19.9717 47.16H17.8477V51H17.0437V42.3H19.5997C20.1677 42.3 20.6477 42.332 21.0397 42.396C21.4397 42.46 21.8077 42.576 22.1437 42.744C22.4797 42.904 22.7317 43.148 22.8997 43.476C23.0677 43.796 23.1517 44.2 23.1517 44.688C23.1517 46.008 22.4917 46.792 21.1717 47.04L23.2837 51H22.3837ZM19.7077 43.032H17.8477V46.428H19.7077C20.0357 46.428 20.3117 46.42 20.5357 46.404C20.7677 46.38 21.0037 46.336 21.2437 46.272C21.4837 46.2 21.6757 46.104 21.8197 45.984C21.9637 45.864 22.0797 45.696 22.1677 45.48C22.2637 45.264 22.3117 45.008 22.3117 44.712C22.3117 44.344 22.2477 44.044 22.1197 43.812C21.9917 43.572 21.7957 43.4 21.5317 43.296C21.2677 43.184 20.9997 43.112 20.7277 43.08C20.4637 43.048 20.1237 43.032 19.7077 43.032ZM25.1601 46.644C25.1601 47.812 25.4521 48.728 26.0361 49.392C26.6201 50.056 27.3721 50.388 28.2921 50.388C29.2121 50.388 29.9641 50.056 30.5481 49.392C31.1321 48.728 31.4241 47.812 31.4241 46.644C31.4241 45.484 31.1281 44.572 30.5361 43.908C29.9521 43.244 29.2041 42.912 28.2921 42.912C27.3801 42.912 26.6281 43.244 26.0361 43.908C25.4521 44.572 25.1601 45.484 25.1601 46.644ZM31.1961 43.392C31.9161 44.216 32.2761 45.3 32.2761 46.644C32.2761 47.988 31.9161 49.076 31.1961 49.908C30.4761 50.74 29.5081 51.156 28.2921 51.156C27.0761 51.156 26.1081 50.74 25.3881 49.908C24.6681 49.076 24.3081 47.988 24.3081 46.644C24.3081 45.3 24.6681 44.216 25.3881 43.392C26.1081 42.56 27.0761 42.144 28.2921 42.144C29.5081 42.144 30.4761 42.56 31.1961 43.392ZM34.5938 42.3V50.256H39.2018V51H33.7898V42.3H34.5938ZM41.0391 42.3V50.256H45.6471V51H40.2351V42.3H41.0391ZM55.2761 48.252C55.4281 47.804 55.5041 47.268 55.5041 46.644C55.5041 46.02 55.4281 45.484 55.2761 45.036C55.1321 44.588 54.9441 44.236 54.7121 43.98C54.4881 43.724 54.1961 43.524 53.8361 43.38C53.4761 43.236 53.1281 43.144 52.7921 43.104C52.4561 43.056 52.0641 43.032 51.6161 43.032H50.3321V50.268H51.6161C52.0641 50.268 52.4561 50.248 52.7921 50.208C53.1281 50.16 53.4761 50.064 53.8361 49.92C54.1961 49.768 54.4881 49.564 54.7121 49.308C54.9441 49.052 55.1321 48.7 55.2761 48.252ZM49.5281 42.3H51.6401C52.3681 42.3 53.0041 42.372 53.5481 42.516C54.1001 42.66 54.5921 42.896 55.0241 43.224C55.4561 43.544 55.7841 43.992 56.0081 44.568C56.2401 45.144 56.3561 45.836 56.3561 46.644C56.3561 47.46 56.2441 48.156 56.0201 48.732C55.7961 49.308 55.4641 49.76 55.0241 50.088C54.5921 50.408 54.1001 50.64 53.5481 50.784C53.0041 50.928 52.3681 51 51.6401 51H49.5281V42.3ZM58.3476 46.644C58.3476 47.812 58.6396 48.728 59.2236 49.392C59.8076 50.056 60.5596 50.388 61.4796 50.388C62.3996 50.388 63.1516 50.056 63.7356 49.392C64.3196 48.728 64.6116 47.812 64.6116 46.644C64.6116 45.484 64.3156 44.572 63.7236 43.908C63.1396 43.244 62.3916 42.912 61.4796 42.912C60.5676 42.912 59.8156 43.244 59.2236 43.908C58.6396 44.572 58.3476 45.484 58.3476 46.644ZM64.3836 43.392C65.1036 44.216 65.4636 45.3 65.4636 46.644C65.4636 47.988 65.1036 49.076 64.3836 49.908C63.6636 50.74 62.6956 51.156 61.4796 51.156C60.2636 51.156 59.2956 50.74 58.5756 49.908C57.8556 49.076 57.4956 47.988 57.4956 46.644C57.4956 45.3 57.8556 44.216 58.5756 43.392C59.2956 42.56 60.2636 42.144 61.4796 42.144C62.6956 42.144 63.6636 42.56 64.3836 43.392ZM71.8873 42.3L73.8433 49.944L76.0153 42.3H76.8793L74.2753 51H73.3513L71.4313 43.704L69.5233 51H68.5993L65.9833 42.3H66.8713L69.0913 49.944L70.9873 42.3H71.8873ZM84.7601 51H83.5961L78.8321 43.164V51H78.0281V42.3H79.1921L83.9561 50.148V42.3H84.7601V51Z" fill="white"/>
        <rect x="35.5" y="0.5" width="16" height="28" rx="8" stroke="white"/>
        <path d="M44 9V20" stroke="white"/>
      </svg>

      <!-- Right: Volume -->
      <svg id="mute-unmute" xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none">
        <g opacity="0.6">
        <mask id="mask0_294_1049" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="29" height="29">
        <path d="M0 -7.62939e-06H29V29H0V-7.62939e-06Z" fill="white"/>
        </mask>
        <g mask="url(#mask0_294_1049)">
        <path d="M5.51198 19.8569H0.849609V9.14364H5.51198V19.8569Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M28.1501 18.7075L19.7354 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19.7354 18.7075L28.1501 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M5.51172 9.14335V14.5V19.8566L15.2378 25.2109C15.7415 25.4882 16.3581 25.1238 16.3581 24.5488V14.5V4.45118C16.3581 3.87617 15.7415 3.5118 15.2378 3.78905L5.51172 9.14335Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        </g>
        </g>
      </svg>
    </div>
  </div>
  {% endif %}
</section>





<script>
  window.addEventListener('load', () => {

  let video;

  const desktopVideo = document.getElementById('background-video-desktop');

  const mobileVideo = document.getElementById('background-video-mobile');

  // function to select the correct video element
    function getActiveVideo() {
      return window.innerWidth <= 768 ? mobileVideo : desktopVideo;
    }
  // function to handle mute/pause on inactive video
  function handleVideoStateChange() {
    const isMobile = window.innerWidth <= 768;

    if (isMobile) {
      if (desktopVideo) {
        desktopVideo.pause();
        desktopVideo.muted = true;
      }
      if (mobileVideo) {
        mobileVideo.play();
        mobileVideo.muted = true;
      }
    } else {
      if (mobileVideo) {
        mobileVideo.pause();
        mobileVideo.muted = true;
      }
      if (desktopVideo) {
        desktopVideo.play();
        desktopVideo.muted = true;
      }
    }
  }

  // initial selection
  video = getActiveVideo();
  handleVideoStateChange();

  // update selection if window is resized across breakpoint
  {% if section.settings.video_mobile != blank  %}
  window.addEventListener('resize', () => {
    const newVideo = getActiveVideo();
    if (newVideo !== video) {
      // Pause + mute the previous one, play + unmute the new one
      video.pause();
      video.muted = true;
      video = newVideo;
      handleVideoStateChange();
    }
  });
  {% endif %}

  // --- Buttons ---
  const playPauseBtn = document.getElementById('play-pause');
  const muteUnmuteBtn = document.getElementById('mute-unmute');
  const scrollDown = document.getElementById('scroll-down');

  // Play/Pause toggle
  playPauseBtn.addEventListener('click', () => {
    if (video.paused) {
      video.play();
      playPauseBtn.innerHTML = `
        <path d="M14.5 0C6.50234 0 0 6.50234 0 14.5C0 22.4977 6.50234 29 14.5 29C22.4977 29 29 22.4977 29 14.5C29 6.50234 22.4977 0 14.5 0ZM14.5 27.1875C7.50488 27.1875 1.8125 21.4951 1.8125 14.5C1.8125 7.50488 7.50488 1.8125 14.5 1.8125C21.4951 1.8125 27.1875 7.50488 27.1875 14.5C27.1875 21.4951 21.4951 27.1875 14.5 27.1875ZM12.2061 9.3627V19.6373C12.2061 20.1357 11.7982 20.5436 11.2998 20.5436C10.8014 20.5436 10.3936 20.1357 10.3936 19.6373V9.3627C10.3936 8.86426 10.8014 8.45645 11.2998 8.45645C11.7982 8.45645 12.2061 8.85859 12.2061 9.3627ZM18.6064 9.3627V19.6373C18.6064 20.1357 18.1986 20.5436 17.7002 20.5436C17.2018 20.5436 16.7939 20.1357 16.7939 19.6373V9.3627C16.7939 8.86426 17.2018 8.45645 17.7002 8.45645C18.1986 8.45645 18.6064 8.85859 18.6064 9.3627Z" fill="white"/>
      `;
    } else {
      video.pause();
      playPauseBtn.innerHTML = `
        <g opacity="0.6">
        <mask id="mask0_294_1049" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="29" height="29">
        <path d="M0 -7.62939e-06H29V29H0V-7.62939e-06Z" fill="white"/>
        </mask>
        <g mask="url(#mask0_294_1049)">
        <path d="M5.51198 19.8569H0.849609V9.14364H5.51198V19.8569Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M28.1501 18.7075L19.7354 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19.7354 18.7075L28.1501 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M5.51172 9.14335V14.5V19.8566L15.2378 25.2109C15.7415 25.4882 16.3581 25.1238 16.3581 24.5488V14.5V4.45118C16.3581 3.87617 15.7415 3.5118 15.2378 3.78905L5.51172 9.14335Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        </g>
        </g> 
      `;
    }
  });

  // Mute/Unmute toggle
  muteUnmuteBtn.addEventListener('click', () => {
    video.muted = !video.muted;
    // (your existing SVG logic preserved)
    muteUnmuteBtn.innerHTML = video.muted ?  `
      <g opacity="0.6">
      <mask id="mask0_294_1049" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="29" height="29">
      <path d="M0 -7.62939e-06H29V29H0V-7.62939e-06Z" fill="white"/>
      </mask>
      <g mask="url(#mask0_294_1049)">
      <path d="M5.51198 19.8569H0.849609V9.14364H5.51198V19.8569Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M28.1501 18.7075L19.7354 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M19.7354 18.7075L28.1501 10.2928" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M5.51172 9.14335V14.5V19.8566L15.2378 25.2109C15.7415 25.4882 16.3581 25.1238 16.3581 24.5488V14.5V4.45118C16.3581 3.87617 15.7415 3.5118 15.2378 3.78905L5.51172 9.14335Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
      </g>
      </g>
    `
      : `
      <path d="M14.5 0C6.50234 0 0 6.50234 0 14.5C0 22.4977 6.50234 29 14.5 29C22.4977 29 29 22.4977 29 14.5C29 6.50234 22.4977 0 14.5 0ZM14.5 27.1875C7.50488 27.1875 1.8125 21.4951 1.8125 14.5C1.8125 7.50488 7.50488 1.8125 14.5 1.8125C21.4951 1.8125 27.1875 7.50488 27.1875 14.5C27.1875 21.4951 21.4951 27.1875 14.5 27.1875ZM12.2061 9.3627V19.6373C12.2061 20.1357 11.7982 20.5436 11.2998 20.5436C10.8014 20.5436 10.3936 20.1357 10.3936 19.6373V9.3627C10.3936 8.86426 10.8014 8.45645 11.2998 8.45645C11.7982 8.45645 12.2061 8.85859 12.2061 9.3627ZM18.6064 9.3627V19.6373C18.6064 20.1357 18.1986 20.5436 17.7002 20.5436C17.2018 20.5436 16.7939 20.1357 16.7939 19.6373V9.3627C16.7939 8.86426 17.2018 8.45645 17.7002 8.45645C18.1986 8.45645 18.6064 8.85859 18.6064 9.3627Z" fill="white"/>
      
      `;
  });

  // Scroll down action
  scrollDown.addEventListener('click', () => {
    window.scrollTo({
      top: window.innerHeight,
      behavior: 'smooth',
    });
  });
});
</script>


{% schema %}
{
  "name": "Autoplay Video",
  "settings": [
    {
      "type": "header",
      "content": "Video Settings"
    },
    {
      "type": "video",
      "id": "video_desktop",
      "label": "Desktop Video",
      "info": "Upload a video for desktop view."
    },
    {
      "type": "video",
      "id": "video_mobile",
      "label": "Mobile Video",
      "info": "Upload a video for mobile view."
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "margin_bottom_desktop",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Desktop",
      "default": 36
    },
    {
      "type": "range",
      "id": "margin_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Mobile",
      "default": 36
    },
    {
      "type": "header",
      "content": "Inner Spacing Desktop Settings"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Top Desktop",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Desktop",
      "default": 60
    },
    {
      "type": "header",
      "content": "Inner Spacing Tablet Settings"
    },
    {
      "type": "range",
      "id": "padding_top_tablet",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Top Tablet",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom_tablet",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Tablet",
      "default": 60
    },
    {
      "type": "header",
      "content": "Inner Spacing Mobile Settings"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Top Mobile",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Mobile",
      "default": 40
    }
  ],
  "presets": [
    {
      "name": "Auto Play Video"
    }
  ]
}
{% endschema %}
