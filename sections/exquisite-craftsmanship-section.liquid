{{ 'exquisite-craftsmanship.css' | asset_url | stylesheet_tag }}
<style>
  @media screen and (min-width:768px){
    #{{ section.id }}{
        margin-bottom: {{ section.settings.margin_bottom_desktop }}px;
     }
     {% if section.settings.gif_bg_image != blank %}
        .exquisite-craftsmanship-section{
          background:url('{{ section.settings.gif_bg_image | image_url }}');
          background-size: 55%;
          background-repeat: repeat-y;
          background-position: right;
        }
     {% endif %}
  }
  @media screen and (max-width: 767px) {
   #{{ section.id }}{
      margin-bottom: {{ section.settings.margin_bottom_mobile }}px;
    }
    {% if section.settings.gif_bg_image_mobile != blank %}
        .exquisite-craftsmanship-section{
           background:url('{{ section.settings.gif_bg_image_mobile | image_url }}');
           background-size: 100% 100%;
           background-repeat: no-repeat;
           background-position: center;
        }
    {% endif %}
  }
</style>
{% if section.blocks != blank %}
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.4.2/ScrollTrigger.min.js"></script>

<section id="{{ section.id }}">
  <div class="page-width exquisite-craftsmanship-section">
    <div class="exquisiteSection">
      <div class="exquisite-wrapper">
        {% for block in section.blocks %}
            <div  class="exquisiteslide">
                <div class="exquisite-craftsmanship-left-content" data="exquisite-image-exquisite-wrapper-{{ forloop.index0 }}">
                        {% if block.settings.heading != blank %}<h2>{{ block.settings.heading }}</h2>{% endif %}
                        {% if block.settings.description != blank %}<p>{{ block.settings.description }}</p>{% endif %}
                        {% unless forloop.last %}
                            {% render 'downward-svg' %}
                        {% endunless %}
                        {% if forloop.last %}
                          {% if section.settings.button_text != blank %}
                              <a href="{% if section.settings.button_url != blank %}{{ section.settings.button_url }}{% else %}javascript:void(0){% endif %}">{{ section.settings.button_text }}</a>
                          {% endif %}
                        {% endif %}
                </div>
                {% if block.settings.right_side_image != blank %}
                      <div class="exquisite-craftsmanship-image-container">
                        {{
                                block.settings.right_side_image
                                | image_url: width: 1600
                                | image_tag: class: 'exquisite-craftsmanship-image', loading: 'lazy'
                      }}
                      </div>
                {% endif %}
            </div>
        {% endfor %}
      </div>
     </div>
  </div>
</section>
<script>
try {
  ScrollTrigger.defaults({
    markers: false
  });

  let exquisiteslides = gsap.utils.toArray('.exquisiteslide');
  let slideheight = 100 * exquisiteslides.length;

  let targetsection = gsap.timeline({
    duration: exquisiteslides.length,
    scrollTrigger: {
      trigger: ".exquisiteSection",
      start: "top center",
      end: "+=" + slideheight + "%",
      scrub: true,
      id: "exquisiteslides",
    }
  });

  let pinner = gsap.timeline({
    scrollTrigger: {
      trigger: ".exquisiteSection .exquisite-wrapper",
      start: "top top",
      end: "+=" + slideheight + "%",
      scrub: true,
      pin: ".exquisiteSection .exquisite-wrapper",
      markers: true
    }
  });

  exquisiteslides.forEach(function (elem, i) {
    try {
      gsap.set(elem, { position: "absolute", top: 0 });

      targetsection.from(elem.querySelector('.exquisite-craftsmanship-image-container'), { autoAlpha: 0 }, i);
      targetsection.from(elem.querySelector('.exquisite-craftsmanship-left-content'), { autoAlpha: 0, translateY: 100 }, i);

      if (i != exquisiteslides.length - 1) {
        targetsection.to(elem.querySelector('.exquisite-craftsmanship-left-content'), { autoAlpha: 0, translateY: -100 }, i + 0.5);
        targetsection.to(elem.querySelector('.exquisite-craftsmanship-image-container'), { autoAlpha: 0 }, i + 0.5);
      }
    } catch (error) {
      console.error("Error animating slide index:", i, error);
    }
  });
} catch (error) {
  console.error("Error initializing GSAP animations:", error);
}
</script>
{% endif %}
{% schema %}
  {
    "name": "Exquisite Craftsmanship",
    "settings": [
       {
          "type": "range",
          "id": "margin_bottom_desktop",
          "min": 0,
          "max": 100,
          "step": 5,
          "unit": "px",
          "label": "Section Spacing",
          "default": 30
      },
      {
        "type": "range",
        "id": "margin_bottom_mobile",
        "min": 0,
        "max": 100,
        "step": 5,
        "unit": "px",
        "label": "Section Spacing",
        "default": 20
      },
      {
            "type": "text",
            "id": "button_text",
            "label": "Button Text",
            "default": "EXPLORE COLLECTION"
      },
      {
         "type": "url",
         "id": "button_url",
         "label": "Button Link"
      },
      {
        "type": "image_picker",
        "id": "gif_bg_image",
        "label": "GIF Background Image"
      },
      {
        "type": "image_picker",
        "id": "gif_bg_image_mobile",
        "label": "Mobile GIF Background Image"
      }
    ],
    "blocks": [
      {
        "type": "imagetext-slide",
        "name":"Image Text Slide",
        "settings": [
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Exquisite Craftsmanship"
          },
          {
            "type": "text",
            "id": "description",
            "label": "Description",
            "default": "Inspired by Indian art and culture, these timepieces are true masterpieces that reflect the essence of luxury"
          },
          {
            "type": "image_picker",
            "id": "right_side_image",
            "label": "Right Side Image"
          }
        ]
      }
    ],
    "presets": [{"name": "Exquisite Craftsmanship"}]
  }
{% endschema %}