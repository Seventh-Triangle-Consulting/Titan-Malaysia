class OneCheckoutUtil{constructor(){this.URL_PARAMS=new URLSearchParams(window.location.search)}apiRequest(e,t,r,o,a,c,s=null){var n=new XMLHttpRequest;n.open(e,t,!0),r.forEach(e=>{n.setRequestHeader(e[0],e[1])}),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?a(JSON.parse(this.responseText)):c(JSON.parse(this.responseText)),s&&s())},n.send(JSON.stringify(o))}set1CheckoutLocalStorage(e,t,r){var o=new Date;o.setTime(o.getTime()+36e5*r),o=o.toUTCString(),localStorage.setItem(e,JSON.stringify({value:t,expires:o}))}get1CheckoutLocalStorage(e){try{var t=JSON.parse(localStorage.getItem(e)),r=new Date().getTime();if(Date.parse(t.expires)>r)return t.value;return this.delete1CheckoutLocalStorage(e),null}catch(o){return null}}delete1CheckoutLocalStorage(e){localStorage.removeItem(e)}get1CheckoutCookie(e){for(var t=e+"=",r=decodeURIComponent(document.cookie).split(";"),o=0;o<r.length;o++){for(var a=r[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}getAllParams(){var e=new URL(window.location.href).searchParams,t={};return e.forEach(function(e,r){t[r]=e}),""!==e.toString()?this.set1CheckoutLocalStorage("queryparams_1c",t,168):t=this.get1CheckoutLocalStorage("queryparams_1c"),t||{}}}const ONE_CHECKOUT_UTIL=new OneCheckoutUtil,IS_DEMO_1C_PAGE=!1,API_HOST_1C="https://api.1checkout.ai",HOST_1C="https://pay.1checkout.ai",API_KEY_1C="e8e1ad8d-ab90-47a2-8f9f-396ff5ec73da",IS_1C_ENABLED=!ONE_CHECKOUT_UTIL.get1CheckoutLocalStorage("d1c")&&!1;class OneCheckoutBtnRenderer{constructor(e,t=!1){IS_1C_ENABLED?this.targetBtns=e:this.targetBtns=[],this.logMutations=t;var r=!1,o=[];this.targetBtns.forEach(e=>{e.urlPattern?window.location.pathname.includes(e.urlPattern)&&o.push(e):o.push(e)}),this.targetBtns=o,this.targetBtns.forEach(e=>{this.hide1CTarget(e),e.pageObserver&&(r=!0)}),this.BTN_OBSERVERS=[],this._obsConfig={childList:!0,subtree:!0},this._obsCallback=(e,t)=>{var r,o;for(var a of(this.BTN_OBSERVERS.forEach(e=>{e.observer==t&&(r=e.btnMeta,o=e.observer)}),e))"childList"===a.type&&a.addedNodes.forEach(e=>{if(this.logMutations&&console.log(e),e.nodeName==r.observeForBtn.nodeName&&e.getAttribute(r.observeForBtn.nodeAttr)==r.observeForBtn.nodeAttrVal){this.hide1CTarget(r,e),this.render1CBtn(r,e),r.observeForBtn.stopObservingWhenFound&&o.disconnect();return}})},this.targetBtns.forEach(e=>{e.observeUrl&&this.initUrlObserver(e)}),this.targetBtns.forEach(e=>{e.observeForBtn&&this.initBtnObserver(e)}),this.paginationObserver,r&&this.initPageObserver()}hide1CTarget(e,t=null){if(t){if(e.hideInstead)var r=t.querySelector(e.hideInstead);else var r=t.querySelector(e.selector)}else if(e.hideInstead)var r=document.querySelector(e.hideInstead);else var r=document.querySelector(e.selector);r&&r.classList.add("dc-none")}render1CBtn(e,t=null){if(t)var r=t.querySelector(e.selector);else var r=document.querySelector(e.selector);if(r){if(t){if(t.getElementsByClassName("btn-group-1checkout").length>0)return}else if(r.parentElement.getElementsByClassName("btn-group-1checkout").length>0)return;var o=document.createElement("div");o.setAttribute("class","btn-group-1checkout"),o.innerHTML=e.dynamicBtn,"before"==e.siblingPosition?r.before(o):r.after(o)}}initBtnObserver(e){var t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;t&&document.querySelectorAll(e.observeForBtn.container).forEach(r=>{var o=new t(this._obsCallback);o.observe(r,this._obsConfig),this.BTN_OBSERVERS.push({btnMeta:e,observer:o})})}initUrlObserver(e){new PerformanceObserver(t=>{for(let r of t.getEntries())"fetch"===r.initiatorType&&r.name.includes(e.observeUrl)&&(this.hide1CTarget(e),this.render1CBtn(e))}).observe({entryTypes:["resource"]})}initPageObserver(){this.paginationObserver=new PerformanceObserver(e=>{for(let t of e.getEntries())"fetch"===t.initiatorType&&t.name.includes("page=")&&this.targetBtns.forEach(e=>{e.observeForBtn&&this.initBtnObserver(e),e.observeEvent&&document.querySelectorAll(e.observeEvent.target).forEach(t=>{t.addEventListener(e.observeEvent.event,function(){this.hide1CTarget(e),this.render1CBtn(e)})})})}),this.paginationObserver.observe({entryTypes:["resource"]})}pageLoad(){this.targetBtns.forEach(e=>{this.render1CBtn(e),e.observeEvent&&document.querySelectorAll(e.observeEvent.target).forEach(t=>{t.addEventListener(e.observeEvent.event,function(){oneCheckoutBtnRenderer.hide1CTarget(e),oneCheckoutBtnRenderer.render1CBtn(e)})})})}}class OneCheckout{constructor(){this.CHECKOUT_CLIENT_IP_ADDRESS=null;try{fetch("https://api64.ipify.org?format=json").then(e=>e.json()).then(e=>{try{this.CHECKOUT_CLIENT_IP_ADDRESS=e.ip}catch(t){}})}catch(e){}if(this.API_HEADERS=[["Content-type","application/json"],["X-LOGISY-API-KEY",API_KEY_1C]],this.CHECKOUT_ID,this.TRIGGER_1CHECKOUT=ONE_CHECKOUT_UTIL.URL_PARAMS.get("t1c"),this.TRIGGER_1CHECKOUT=this.TRIGGER_1CHECKOUT&&"true"==this.TRIGGER_1CHECKOUT.toLowerCase()&&IS_1C_ENABLED,this.REFRESH_CART=ONE_CHECKOUT_UTIL.URL_PARAMS.get("refresh"),this.REFRESH_CART=this.REFRESH_CART&&"true"==this.REFRESH_CART.toLowerCase(),this.CHECKOUT_CART={getCartItemCount:function(){var e=0;return this.CHECKOUT_CART.items.forEach(t=>{e+=t.quantity}),e},getCartItemDetails:function(){var e=[];return this.CHECKOUT_CART.items.forEach(t=>{e.push({id:t.id.toString(),quantity:t.quantity,name:t.title})}),e},getCartProductIds:function(){var e=[];return this.CHECKOUT_CART.items.forEach(t=>{e.push(t.product_id.toString())}),e}},this.loaderMessages1Checkout=["Carefully wrapping your items","Crossing T’s & dotting I’s","Juuust a moment..","Adding the cherry on top"],this.loaderMessagesTimer=null,this._messageIdx=0,this.CHECKOUT_URL,this.QUERY_PARAMS_1C=ONE_CHECKOUT_UTIL.getAllParams(),this.TRIGGER_1CHECKOUT&&(document.body.style.overflow="hidden",document.querySelector(".checkout-progressbar").classList.remove("dc-none"),document.getElementById("checkoutModal").checked=!0,this.startLoaderMessages()),!this.TRIGGER_1CHECKOUT&&this.REFRESH_CART){var t,r='<div id="checkoutRedirectOverlay" style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0,0,0,0.9); z-index: 1063;"><span style="position: absolute; border: 3px solid #fff; border-top: 3px solid #0000; border-radius: 50%; width: 32px; height: 32px; left: calc(50% - 16px); top: calc(50% - 16px)"></span></div>';document.querySelector("body").innerHTML+=r,document.querySelector("#checkoutRedirectOverlay span").animate([{transform:"rotate(360deg)"}],{duration:1e3,iterations:1/0})}}startLoaderMessages(){this.loaderMessagesTimer=setInterval(function(){document.getElementById("checkoutLoadingMessage").innerHTML=oneCheckout.loaderMessages1Checkout[oneCheckout._messageIdx],oneCheckout._messageIdx+=1,oneCheckout._messageIdx==oneCheckout.loaderMessages1Checkout.length&&oneCheckout.resetSplashScreen()},2e3)}resetSplashScreen(){clearInterval(this.loaderMessagesTimer),this._messageIdx=0,document.getElementById("checkoutLoadingMessage").innerHTML="Initializing...",document.querySelector(".checkout-progressbar").classList.add("dc-none")}addOneItemAfterAnotherToCart(e,t,r){var o=e.pop();if(o)ONE_CHECKOUT_UTIL.apiRequest("POST","/cart/add.js",[["Content-type","application/json; charset=UTF-8"]],{items:[o]},function(e){},function(e){t.push(e.description)},function(){oneCheckout.addOneItemAfterAnotherToCart(e,t,r)});else if(t.length>0){unaddedItemsHtml="",t.forEach(e=>{unaddedItemsHtml+=`<li style="text-align: left;">${e}</li>`});var a=`<div style="text-align: center; color: #404143;"><ul style="max-height: 118px;overflow-y: auto;">${unaddedItemsHtml}</ul></div>`,c="position: absolute; display: flex; flex-direction: column; align-items: center;";c+="width: 350px; left: calc(50% - 175px); top: 30%;";var s=`<div style="${c+="background-color: #fff; border-radius: 4px; padding: 16px;"}"><h3 style="text-align: center; color: #404143;">Oops!</h3>${a}<a href="/cart" style="margin-top: 16px;background-color: #404143;color: #fff;padding: 8px 46px;border-radius: 4px;text-decoration: none;">Ok</a></div>`;document.getElementById("checkoutRedirectOverlay").innerHTML=s}else if(this.TRIGGER_1CHECKOUT){var n={showError:!1};try{n.phone=r.user_phone_number}catch(i){}n.checkout_type="checkout",this.initCheckoutIframe(n);let l=document.querySelector(".checkoutmodal .iframe-container iframe");l.onload=function(){l.contentWindow.postMessage({checkout_id:r.checkout_id,checkout_url:r.checkout_url,topic:"1CHECKOUTDATA"},"*"),oneCheckout.checkoutLoaded()}}else this.REFRESH_CART&&window.location.replace("/cart")}triggerWA1CheckoutOnPageLoad(){["/cart","/cart/"].includes(window.location.pathname)&&this.REFRESH_CART&&(this.CHECKOUT_ID=ONE_CHECKOUT_UTIL.URL_PARAMS.get("cid"),this.CHECKOUT_ID&&ONE_CHECKOUT_UTIL.apiRequest("GET",`${API_HOST_1C}/checkouts/${this.CHECKOUT_ID}`,this.API_HEADERS,{},function(e){ONE_CHECKOUT_UTIL.apiRequest("GET","/cart/clear.js",[["Content-type","application/json; charset=UTF-8"]],{},function(t){var r=[];e.cart.items.forEach(e=>{r.push({id:e.variant_id,quantity:e.quantity})}),oneCheckout.addOneItemAfterAnotherToCart(r,[],e)},function(e){},function(){})},function(e){console.log(e)}))}checkVariantAvailability(e){try{var t=document.getElementById("productHandle1Checkout").value;t?ONE_CHECKOUT_UTIL.apiRequest("GET",`/products/${t}.js`,[["Content-type","application/json; charset=UTF-8"]],{},function(t){var r=!0;t.variants.forEach(t=>{t.id==e&&(r=t.available)}),r?document.getElementById("buyNow1CheckoutBtn").disabled=!1:document.getElementById("buyNow1CheckoutBtn").disabled=!0},function(e){}):document.getElementById("buyNow1CheckoutBtn").disabled=!1,document.getElementById("buyNow1CheckoutError").classList.add("dc-none")}catch(r){}}checkoutModalToggled(e){!0==e.checked?(document.querySelector(".checkout-progressbar").classList.remove("dc-none"),this.startLoaderMessages(),document.body.style.overflow="hidden",this.initialize1Checkout()):document.body.style.overflow=null}trigger1Checkout(e){var t=document.getElementById("1cGiftCard");if(t&&null!==t&&t.checked)e.disabled=!0,e.querySelector(".btn-1checkout-title").classList.add("dc-none"),e.querySelector(".btn-1checkout-sub-title").classList.add("dc-none"),e.querySelector(".btn-1checkout-spinner").classList.remove("dc-none"),ONE_CHECKOUT_UTIL.apiRequest("GET","/cart.json",[["Content-type","application/json"]],{},function(t){window.location.href=`${window.location.origin}/checkouts/cn/${t.token}/information`,setTimeout(()=>{e.disabled=!1,e.querySelector(".btn-1checkout-title").classList.remove("dc-none"),e.querySelector(".btn-1checkout-sub-title").classList.remove("dc-none"),e.querySelector(".btn-1checkout-spinner").classList.add("dc-none")},4e3)});else{var r=document.getElementById("checkoutModal");r.checked=!0,this.checkoutModalToggled(r)}}buyNow1Checkout(e){document.getElementById("buyNow1CheckoutError").classList.add("dc-none"),e.disabled=!0,e.querySelector(".btn-1checkout-title").classList.add("dc-none"),e.querySelector(".btn-1checkout-sub-title").classList.add("dc-none"),e.querySelector(".btn-1checkout-spinner").classList.remove("dc-none");try{var t=e.closest("form").querySelector('[name="id"]').value}catch(r){var t=document.querySelector('[name="id"]').value}try{try{var o=e.closest("form").querySelector('[name="quantity"]').value}catch(a){var o=document.querySelector('[name="quantity"]').value}}catch(c){var o=1}var s={};document.querySelectorAll('[name*="properties["]').forEach(e=>{var t=e.getAttribute("name");(t=t.match(/\[(.*)\]/i)).length>1&&(s[t[1]]=e.value)}),ONE_CHECKOUT_UTIL.apiRequest("GET","/cart/clear.js",[["Content-type","application/json; charset=UTF-8"]],{},function(e){ONE_CHECKOUT_UTIL.apiRequest("POST","/cart/add.js",[["Content-type","application/json; charset=UTF-8"]],{items:[{id:t,quantity:o,properties:s}]},function(e){document.getElementById("checkoutModal").click(),document.documentElement.dispatchEvent(new CustomEvent("product:added",{bubbles:!0,detail:{variant:t,quantity:o}}))},function(e){e.description&&(document.getElementById("buyNow1CheckoutError").innerHTML=e.description),document.getElementById("buyNow1CheckoutError").classList.remove("dc-none")})},function(e){},function(){e.querySelector(".btn-1checkout-title").classList.remove("dc-none"),e.querySelector(".btn-1checkout-sub-title").classList.remove("dc-none"),e.querySelector(".btn-1checkout-spinner").classList.add("dc-none"),e.disabled=!1})}initialize1Checkout(){ONE_CHECKOUT_UTIL.apiRequest("GET","/cart.json",[["Content-type","application/json"]],{},function(e){let t=document.getElementById("district"),r=document.getElementById("club-name");t&&(oneCheckout.CHECKOUT_CART={...oneCheckout.CHECKOUT_CART,district:t.value}),r&&(oneCheckout.CHECKOUT_CART={...oneCheckout.CHECKOUT_CART,club_name:r.value}),oneCheckout.CHECKOUT_CART={...oneCheckout.CHECKOUT_CART,...e},ONE_CHECKOUT_UTIL.apiRequest("POST",`${API_HOST_1C}/create`,oneCheckout.API_HEADERS,oneCheckout.CHECKOUT_CART,function(e){oneCheckout.CHECKOUT_ID=e.checkout_id,oneCheckout.CHECKOUT_URL=e.checkout_url;let t=document.querySelector(".checkoutmodal .iframe-container iframe");t.contentWindow.postMessage({checkout_id:e.checkout_id,checkout_url:e.checkout_url,topic:"1CHECKOUTDATA"},"*")},function(e){console.log(e),oneCheckout.initCheckoutIframe({showError:!0,checkout_type:"checkout"})})},function(e){console.log(e),oneCheckout.initCheckoutIframe({showError:!0,checkout_type:"checkout"})})}initCheckoutIframe(e){e.containerheight=document.querySelector(".checkoutmodal .inner").offsetHeight,e.apikey=API_KEY_1C;var t=new URL(`${HOST_1C}/v3/checkout/widget/`);Object.keys(e).forEach(r=>{null!==e[r]&&t.searchParams.set(r.toLowerCase(),e[r])});var r=ONE_CHECKOUT_UTIL.get1CheckoutCookie("_fbc");r&&t.searchParams.set("fbclid",r),this.CHECKOUT_CLIENT_IP_ADDRESS&&t.searchParams.set("ip",this.CHECKOUT_CLIENT_IP_ADDRESS),Object.keys(this.QUERY_PARAMS_1C).forEach(e=>{t.searchParams.set(e,this.QUERY_PARAMS_1C[e])});var o=ONE_CHECKOUT_UTIL.get1CheckoutCookie("_fbp");o&&t.searchParams.set("fbp",o);var a=ONE_CHECKOUT_UTIL.get1CheckoutCookie("_ga");a&&t.searchParams.set("ga",a),t.searchParams.set("url",encodeURI(window.location.href)),"checkout"==e.checkout_type&&(document.querySelector(".checkoutmodal .iframe-container").innerHTML=`<iframe src="${t.href}" onload="oneCheckout.checkoutLoaded()" class="dc-none"></iframe>`)}exitLoaderAnimation(){let e=document.querySelector(".checkoutmodal .splash-screen"),t=document.querySelector(".checkout-progressbar p");t.style.color="#fff",e.animate([{opacity:1},{opacity:0}],{duration:700}),setTimeout(()=>{document.querySelector(".checkoutmodal .splash-screen").classList.add("dc-none")},700)}checkoutLoaded(){var e=document.querySelector(".checkoutmodal iframe");e.classList.remove("dc-none"),document.querySelector(".checkoutmodal .splash-screen").classList.add("dc-none"),this.resetSplashScreen(),this.CHECKOUT_ID&&this.CHECKOUT_URL&&e.contentWindow.postMessage({checkout_id:this.CHECKOUT_ID,checkout_url:this.CHECKOUT_URL,topic:"1CHECKOUTDATA"},"*")}startAnimation(){let e=document.querySelector(".bounce-loader");e.style.animation="none",e.offsetHeight,e.style.animation="bounce-anim 3s forwards 100ms"}messageListener(e){if(e.origin==HOST_1C&&"1CHECKOUT"==e.data.topic){if("launch_truecaller"==e.data.message)document.location=e.data.truecallerDeeplink;else if("exit_checkout"==e.data.message)document.querySelector(".checkoutmodal .overlay").classList.add("dc-none"),document.querySelector(".checkoutmodal .splash-screen").classList.remove("dc-none"),document.getElementById("checkoutModal").click(),document.querySelector(".checkoutmodal iframe").remove(),this.initCheckoutIframe({showError:!1,checkout_type:"checkout"}),e.data.fallback&&ONE_CHECKOUT_UTIL.set1CheckoutLocalStorage("d1c",!0,4),e.data.nextPage&&window.location.replace(e.data.nextPage),this.CHECKOUT_ID=ONE_CHECKOUT_UTIL.URL_PARAMS.get("cid"),this.CHECKOUT_ID&&this.TRIGGER_1CHECKOUT&&window.location.replace(`/cart?cid=${this.CHECKOUT_ID}&t1c=false&refresh=false`);else if("clear_cart"==e.data.message)ONE_CHECKOUT_UTIL.apiRequest("POST","/cart/clear.js",[["Content-type","application/json; charset=UTF-8"]],{},function(e){},function(e){});else if("launch_upi_app"==e.data.message)document.location=e.data.deeplink;else if("checkout_conversion"==e.data.message)setTimeout(function(){window.location.replace(e.data.nextPage)},3e3);else if("create_abandoned_checkout"==e.data.message)try{fetch(e.data.checkoutUrl).then(e=>{})}catch(t){}else if("redirect_to_home"==e.data.message)try{window.location.replace(e.data.nextPage)}catch{}}}pageLoad(){this.triggerWA1CheckoutOnPageLoad();try{document.querySelector('[name="id"]').addEventListener("change",function(){oneCheckout.checkVariantAvailability(parseInt(this.value))})}catch(e){}var t="checkout";["/cart","/cart/"].includes(window.location.pathname)&&this.REFRESH_CART&&(t="wa_checkout"),this.initCheckoutIframe({showError:!1,checkout_type:t})}variantChanged(e){oneCheckout.checkVariantAvailability(e.detail.variant.id)}}var oneCheckout=new OneCheckout;oneCheckout.pageLoad();